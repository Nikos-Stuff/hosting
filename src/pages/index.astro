---
import PageLayout from "@layouts/PageLayout.astro";
import { SITE } from "@consts";
import { getCollection } from "astro:content";
import MeteorShower from "@components/MeteorShower.astro";
import TwinklingStars from "@components/TwinklingStars.astro";
import BackgroundFX from "@components/page_effects/BackgroundFX.astro";
import POD from "@components/POD.astro";
import DynamicTitle from "@components/TitleHeader.astro";
import FancyDiv from "@components/FancyDiv.astro";
import Accordion from "@components/Accordion.astro";
import Calculator from "@components/Hosting_Calc.astro";

import { Image } from "astro:assets";

import squid_servers from "@assets/hosting/squid_servers.png";
import WhyUs from "@components/WhyUs.astro";

import BlogSummary from "@components/BlogSummary";

const posts = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => {
    // Sort by date and time
    const dateA = new Date(a.data.date);
    const dateB = new Date(b.data.date);

    const timeA = a.data.time || "00:00";
    const timeB = b.data.time || "00:00";

    const dateTimeA = new Date(`${dateA.toDateString()} ${timeA}`);
    const dateTimeB = new Date(`${dateB.toDateString()} ${timeB}`);

    return dateTimeB.getTime() - dateTimeA.getTime();
  })
  .slice(0, 2);
---

<PageLayout title="Hosting" description={SITE.DESCRIPTION}>
  <!-- <script is:inline data-astro-rerun async src="/js/scroll_animation.js"
  ></script> -->

  <POD />
  <!-- Light Mode: Particles -->
  <div class="absolute inset-0 block dark:hidden">
    <div id="particles1" class="fixed inset-0"></div>
    <div id="particles2" class="fixed inset-0"></div>
    <div id="particles3" class="fixed inset-0"></div>
  </div>

  <!-- Dark Theme: Stars -->
  <div class="absolute inset-0 hidden dark:block">
    <div id="stars1" class="fixed inset-0"></div>
    <div id="stars2" class="fixed inset-0"></div>
    <div id="stars3" class="fixed inset-0"></div>
  </div>

  <!-- Dark Theme: Twinkling Stars / Metors -->
  <div id="galaxy" class="fixed inset-0">
    <div class="hidden dark:block">
      <TwinklingStars />
      <MeteorShower />
    </div>
  </div>

  <!-- <script is:inline defer src="/js/bg.js"></script> -->
  <BackgroundFX />
  <!-- HERO -->
  <section
    id="hero_fade"
    class="snap-center grid w-full h-svh place-items-center relative text-center overflow-hidden transition-all"
  >
    <!-- <div id="planetcont" class='animate absolute inset-0 top-3/4 overflow-hidden z-10'> PLANET HAS BEEN REMOVED FOR A TEST NEW LAYOUT 
            <div id="crescent"
                 class='absolute top-0 left-1/2 -translate-x-1/2 w-[250vw] min-h-[100vh] aspect-square rounded-full p-[1px] bg-gradient-to-b from-black/25 dark:from-white/75 from-0% to-transparent to-5%'>
                <div id="planet"
                     class='w-full h-full bg-white dark:bg-black rounded-full p-[1px] overflow-hidden flex justify-center'>
                    <div id="blur" class='w-full h-5 rounded-full bg-neutral-900/25 dark:bg-white/25 blur-2xl'/>
                </div>
            </div>
        </div> -->
    <DynamicTitle
      text="HOSTING"
      sub="Simple, Free, Reliable"
      buttons={true}
      typewriter={true}
    />
  </section>

  <!-- Blocker when we place an order -->
  <div
    hidden
    id="order_blocker"
    class="fixed inset-0 bg-black/50 dark:bg-black/70 z-50 flex items-center justify-center backdrop-blur-2xl"
  >
    <div
      data-cursor-hover="true"
      data-cursor-parallax="true"
      class="border border-black/15 dark:border-white/20 bg-white dark:bg-black rounded-lg p-6 flex flex-col items-center"
    >
      <svg
        class="animate-spin h-12 w-12 mr-3 fill-black dark:fill-white"
        viewBox="0 -960 960 960"
      >
        <path
          d="M479.98-116q-74.81 0-141.26-27.84-66.44-27.84-116.74-78.14t-78.14-116.69Q116-405.06 116-480.15q0-75.09 28-141.47T222-738q50-50 116.6-78 66.59-28 141.4-28 7.93 0 12.96 4.77 5.04 4.78 5.04 12.58 0 7.81-5.04 12.73Q487.93-809 480-809q-136.75 0-232.88 96.17-96.12 96.18-96.12 233Q151-343 247.17-247q96.18 96 233 96Q617-151 713-247.12q96-96.13 96-232.88 0-7.98 4.96-12.99 4.95-5.01 12.76-5.01t12.54 5.04Q844-487.93 844-480q0 74.81-28 141.4Q788-272 738-222t-116.6 78q-66.61 28-141.42 28Z"
        ></path>
      </svg>
      <h2 class="text-lg font-semibold mb-2">Creating your server!</h2>
      <p class="text-sm text-muted text-center mb-5">
        Please wait while we set up your free game server. This process usually
        takes less than a minute.
      </p>

      <p id="order_activity" class="text-xs">Waiting...</p>
    </div>
  </div>

  <div class="relative">
    <!-- Why Us Section -->
    <WhyUs />

    <FancyDiv isAnimated={true} theme="default_big" margin_bottom="24">
      <section id="features" class="relative animate">
        <p
          class="text-xl md:text-2xl lg:text-3xl font-bold uppercase text-black dark:text-white animate"
        >
          Is that even real?
        </p>

        <p class="font-bold text-sm mb-2 animate">
          Yes! Free game server hosting, forever. No catch, no ads, no trials.
          Here's what we offer:
        </p>
      </section>
    </FancyDiv>

    <FancyDiv isAnimated={true} theme="default_big" margin_bottom="20">
      <section class="relative animate min-h-43.5 flex items-center">
        <span
          aria-hidden="true"
          class="absolute left-4 top-1/2 -translate-y-1/2 text-[6rem] md:text-[8rem] lg:text-[10rem] font-black leading-none text-black/5 dark:text-white/5 pointer-events-none select-none"
        >
          1
        </span>

        <div class="ml-22 md:ml-30 lg:ml-38">
          <p
            class="text-xl md:text-2xl lg:text-3xl font-bold uppercase text-black dark:text-white animate"
          >
            No overcomplicated panels
          </p>

          <p>
            Enjoy a clean, unmodded Pelican Panel designed for simplicity and
            ease of use. Focus on what matters â€” your server â€” not navigating
            complex interfaces. Always up to date, with no bloat or
            distractions. Just pure, straightforward server management.
          </p>
        </div>
      </section>
    </FancyDiv>

    <FancyDiv isAnimated={true} theme="default_big" margin_bottom="20">
      <section class="relative animate min-h-43.5 flex items-center">
        <span
          aria-hidden="true"
          class="absolute left-4 top-1/2 -translate-y-1/2 text-[6rem] md:text-[8rem] lg:text-[10rem] font-black leading-none text-black/5 dark:text-white/5 pointer-events-none select-none"
        >
          2
        </span>

        <div class="ml-22 md:ml-30 lg:ml-38">
          <p
            class="text-xl md:text-2xl lg:text-3xl font-bold uppercase text-black dark:text-white animate"
          >
            Wide Game Support
          </p>

          <p>
            Host a variety of games, including Minecraft (Java & Bedrock),
            FiveM, Rust, and more coming soon! Our platform supports multiple
            game types, so you can create the perfect server for your gaming
            needs.
          </p>
        </div>
      </section>
    </FancyDiv>

    <FancyDiv isAnimated={true} theme="default_big" margin_bottom="20">
      <section class="relative animate min-h-43.5 flex items-center">
        <span
          aria-hidden="true"
          class="absolute left-4 top-1/2 -translate-y-1/2 text-[6rem] md:text-[8rem] lg:text-[10rem] font-black leading-none text-black/5 dark:text-white/5 pointer-events-none select-none"
        >
          3
        </span>

        <div class="ml-22 md:ml-30 lg:ml-38">
          <p
            class="text-xl md:text-2xl lg:text-3xl font-bold uppercase text-black dark:text-white animate"
          >
            Active 24/7
          </p>

          <p>
            Our free hosting is available around the clock, ensuring your
            friends can join anytime. With reliable uptime, your game servers
            are always ready for action.
          </p>
        </div>
      </section>
    </FancyDiv>

    <FancyDiv isAnimated={true} theme="default_big" margin_bottom="24">
      <section class="relative animate min-h-43.5 flex items-center">
        <span
          aria-hidden="true"
          class="absolute left-4 top-1/2 -translate-y-1/2 text-[6rem] md:text-[8rem] lg:text-[10rem] font-black leading-none text-black/5 dark:text-white/5 pointer-events-none select-none"
        >
          4
        </span>

        <div class="ml-22 md:ml-30 lg:ml-38">
          <p
            class="text-xl md:text-2xl lg:text-3xl font-bold uppercase text-black dark:text-white animate"
          >
            Constantly Improving
          </p>

          <p>
            Weâ€™re committed to enhancing our hosting services. Regular updates
            and new features are added based on user feedback, ensuring an
            ever-improving experience.
          </p>
        </div>
      </section>
    </FancyDiv>

    <FancyDiv isAnimated={true} theme="default_big" margin_bottom="24">
      <section class="relative animate">
        <p
          class="text-xl md:text-2xl lg:text-3xl font-bold uppercase text-black dark:text-white animate"
        >
          Our hosting vs Other solutions
        </p>
        <p class="font-bold text-sm mb-2 animate">Quick summary of stuff</p>

        <div class="overflow-x-auto mt-6 animate rounded-lg">
          <table class="min-w-full border border-zinc-200 dark:border-zinc-800">
            <thead class="bg-zinc-100 dark:bg-zinc-900">
              <tr>
                <th
                  class="px-4 py-3 text-left text-sm font-bold text-zinc-700 dark:text-zinc-300"
                >
                  Feature
                </th>
                <th
                  class="px-4 py-3 text-left text-sm font-bold text-green-600"
                >
                  Our Hosting
                </th>
                <th
                  class="px-4 py-3 text-left text-sm font-bold text-zinc-600 dark:text-zinc-400"
                >
                  Aternos.org
                </th>
                <th
                  class="px-4 py-3 text-left text-sm font-bold text-zinc-600 dark:text-zinc-400"
                >
                  Playit.gg
                </th>
                <th
                  class="px-4 py-3 text-left text-sm font-bold text-zinc-600 dark:text-zinc-400"
                >
                  Other Free Hosting
                </th>
              </tr>
            </thead>

            <tbody class="divide-y divide-zinc-200 dark:divide-zinc-800">
              <tr>
                <td
                  class="px-4 py-3 font-semibold bg-zinc-100 dark:bg-zinc-900 border-r border-zinc-200 dark:border-zinc-800"
                >
                  Ads
                </td>
                <td class="px-4 py-3 text-green-600 font-semibold">No ads</td>
                <td class="px-4 py-3">Heavy ads</td>
                <td class="px-4 py-3">No ads</td>
                <td class="px-4 py-3">Usually yes</td>
              </tr>

              <tr>
                <td
                  class="px-4 py-3 font-semibold bg-zinc-100 dark:bg-zinc-900 border-r border-zinc-200 dark:border-zinc-800"
                >
                  Uptime
                </td>
                <td class="px-4 py-3 text-green-600 font-semibold">24/7</td>
                <td class="px-4 py-3">Session-based</td>
                <td class="px-4 py-3">Requires PC online</td>
                <td class="px-4 py-3">Limited</td>
              </tr>

              <tr>
                <td
                  class="px-4 py-3 font-semibold bg-zinc-100 dark:bg-zinc-900 border-r border-zinc-200 dark:border-zinc-800"
                >
                  CPU
                </td>
                <td class="px-4 py-3 text-green-600 font-semibold">
                  Ryzen 5 / 7 / 9
                </td>
                <td class="px-4 py-3">Shared / limited</td>
                <td class="px-4 py-3">Your own PC</td>
                <td class="px-4 py-3">Low-end VPS</td>
              </tr>

              <tr>
                <td
                  class="px-4 py-3 font-semibold bg-zinc-100 dark:bg-zinc-900 border-r border-zinc-200 dark:border-zinc-800"
                >
                  Cost
                </td>
                <td class="px-4 py-3 text-green-600 font-semibold">
                  Free forever
                </td>
                <td class="px-4 py-3">Free</td>
                <td class="px-4 py-3">Free</td>
                <td class="px-4 py-3">Free / upsells</td>
              </tr>

              <tr>
                <td
                  class="px-4 py-3 font-semibold bg-zinc-100 dark:bg-zinc-900 border-r border-zinc-200 dark:border-zinc-800"
                >
                  Business model
                </td>
                <td class="px-4 py-3 text-green-600 font-semibold">
                  100% non-profit (donations)
                </td>
                <td class="px-4 py-3">Ad-driven</td>
                <td class="px-4 py-3">Tunnels & limits</td>
                <td class="px-4 py-3">Ads / paid tiers</td>
              </tr>

              <tr>
                <td
                  class="px-4 py-3 font-semibold bg-zinc-100 dark:bg-zinc-900 border-r border-zinc-200 dark:border-zinc-800"
                >
                  Panel
                </td>
                <td class="px-4 py-3 text-green-600 font-semibold">
                  Pelican Panel
                </td>
                <td class="px-4 py-3">Custom</td>
                <td class="px-4 py-3">None</td>
                <td class="px-4 py-3">Basic / custom</td>
              </tr>

              <tr>
                <td
                  class="px-4 py-3 font-semibold bg-zinc-100 dark:bg-zinc-900 border-r border-zinc-200 dark:border-zinc-800"
                >
                  Community support
                </td>
                <td class="px-4 py-3 text-green-600 font-semibold">Yes</td>
                <td class="px-4 py-3">Limited</td>
                <td class="px-4 py-3">Yes</td>
                <td class="px-4 py-3">Varies</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </FancyDiv>

    <FancyDiv isAnimated={true} theme="default_big" margin_bottom="50">
      <section id="features" class="relative animate">
        <p
          class="text-xl md:text-2xl lg:text-3xl font-bold uppercase text-black dark:text-white animate"
        >
          Okay! You convinced me. What's next?
        </p>

        <p class="font-bold text-sm mb-2 animate">
          Getting started is easy! Use our simple setup desk below to set up
          your free game server in minutes.
        </p>
      </section>
    </FancyDiv>

    <FancyDiv isAnimated={true} theme="default_big" margin_bottom="10">
      <section class="relative animate">
        <p
          class="text-xl md:text-2xl lg:text-3xl font-bold uppercase text-black dark:text-white animate"
        >
          Support Us! Leave a tip :)
        </p>
        <p class="font-bold text-sm mb-2 animate">
          If you like what we do and want to support the project, consider
          leaving a tip. Every little bit helps us maintain and improve our free
          hosting services.
        </p>

        <!-- Progress bar of the tip -->
        <div class="flex items-center mb-4">
          <span id="tip_value" class="text-sm text-muted mr-3">0$</span>
          <div class="flex-1 bg-black/10 dark:bg-white/10 rounded-full h-2">
            <div
              id="tip_progress_bar"
              class="bg-black dark:bg-white h-2 rounded-full transition-all duration-500 ease-in-out"
              style="width: 0%;"
            >
            </div>
          </div>
          <span class="text-sm text-muted ml-3">60$</span>
        </div>

        <button
          id="tip_website_btn"
          class="rainbow_button group w-full p-4 mt-5 gap-3 flex items-center border rounded-lg dark:bg-black bg-white hover:bg-black/5 hover:dark:bg-white/10 border-black/15 dark:border-white/20 transition-all duration-300 ease-in-out"
          onclick="window.open('https://ko-fi.com/niko96758', '_blank')"
        >
          <span
            class="w-full z-10 relative group-hover:text-black group-hover:dark:text-white text-center transition-color duration-300"
          >
            Visit Ko-fi Page
          </span>
        </button>
      </section>
    </FancyDiv>

    <FancyDiv isAnimated={true} theme="default_big" margin_bottom="50">
      <section class="relative animate">
        <!-- OPEN BETA NOTICE -->
        <div
          class="w-full p-4 mb-5 gap-3 flex items-center border rounded-lg bg-yellow-100/50 border-yellow-300 dark:bg-yellow-900/30 dark:border-yellow-700 transition-all duration-300 ease-in-out"
        >
          <p>
            You can now hop in and create your free server!<br />
            Notice that we are currently in open beta testing phase - so we are using
            a little bit slower and less powerful hardware than usual.<br />
            Full launch with better hardware is coming soon! Thank you for your patience
            and support!<br />
            Opps! I bricked the backed. This will be fixed soon ðŸ’€
          </p>
        </div>
        <p
          class="text-xl md:text-2xl lg:text-3xl font-bold uppercase text-black dark:text-white animate"
        >
          Setup Desk
        </p>
        <p class="font-bold text-sm mb-2 animate">
          Easy server setup in 3 simple steps:
        </p>

        <Calculator />

        <!-- Line -->
        <hr class="border-black/10 dark:border-white/25 animate my-5" />

        <p
          class="text-xl md:text-2xl lg:text-3xl font-bold uppercase text-black dark:text-white animate"
        >
          Liked the idea? Share your interest!
        </p>
        <p class="font-bold text-sm mb-2 animate">
          I was planning to launch something like this for a while. To provide a
          good place to host your servers for free - for your friends or small
          communities. If you liked what you saw and want to support the
          project, please fill out the interest form below. It helps me a lot to
          understand how many people would be interested in using such a
          service.
        </p>

        <div class="animate">
          <a
            id="place_order_btn"
            href="https://forms.gle/M6DXeg3NzyFWBsn17"
            target="_blank"
            class="group w-full p-4 mt-5 gap-3 flex items-center border rounded-lg hover:bg-black/5 hover:dark:bg-white/10 border-black/15 dark:border-white/20 transition-all duration-300 ease-in-out"
          >
            <span
              class="w-full z-10 relative group-hover:text-black group-hover:dark:text-white text-center transition-color duration-300"
            >
              Fill Out Interest Form
            </span>
          </a>
        </div>

        <!-- Line -->
        <!-- <hr class="border-black/10 dark:border-white/25 animate my-5" /> -->

        <!-- <p
          class="text-xl md:text-2xl lg:text-3xl font-bold uppercase text-black dark:text-white animate"
        >
          ZarzÄ…dzaj Swoimi UsÅ‚ugami
        </p>
        <p class="font-bold text-sm mb-2 animate">
          PrzedÅ‚uÅ¼, modyfikuj lub anuluj swoje usÅ‚ugi.
        </p>

        <ExtendService /> -->
      </section>
    </FancyDiv>

    <FancyDiv isAnimated={true} theme="default_big" margin_bottom="50">
      <section class="relative animate">
        <h2
          class="font-bold text-3xl mb-0 text-black dark:text-white uppercase"
        >
          Other cool solutions
        </h2>
        <p>Check out some interesting tools and projects!</p>

        <div
          class="relative w-full h-52 mt-6 overflow-hidden rounded-lg animate"
        >
          <Image
            src={squid_servers}
            alt="SquidServers background"
            class="absolute inset-0 w-full h-full object-cover filter blur-sm"
          />

          <div class="absolute inset-0 bg-black/40"></div>

          <div
            class="relative z-10 flex flex-col items-center justify-center h-full text-center px-4 animate"
          >
            <h3 class="text-2xl font-bold text-white mb-2 animate">
              SquidServers
            </h3>
            <p class="text-white mb-4 animate">
              Self-host your own server in minutes. <br />
              No port forwarding. No complex setup. All owned by you.
            </p>
            <div class="animate">
              <a
                href="https://squidservers.com"
                target="_blank"
                class="group h-10 p-4 gap-3 flex items-center border rounded-lg hover:scale-105 hover:bg-white/10 border-white/20 transition-all duration-300 ease-in-out w-full sm:w-auto whitespace-normal wrap-break-word"
              >
                <span class="w-full z-10 relative text-white text-center">
                  Check it out
                </span>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke-width="2.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="stroke-white z-10"
                >
                  <line
                    x1="5"
                    y1="12"
                    x2="19"
                    y2="12"
                    class="scale-x-0 group-hover:scale-x-100 translate-x-4 group-hover:translate-x-1 transition-all duration-300 ease-in-out"
                  ></line>
                  <polyline
                    points="12 5 19 12 12 19"
                    class="translate-x-0 group-hover:translate-x-1 transition-all duration-300 ease-in-out"
                  ></polyline>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </section>
    </FancyDiv>

    <FancyDiv isAnimated={true} theme="default_big" margin_bottom="50">
      <section class="relative animate">
        <h2 class="font-bold text-3xl mb-8 text-black dark:text-white">FAQ</h2>

        <div>
          <Accordion
            title="Why 'free forever'?"
            details="We believe that everyone should have access to reliable game server hosting without financial barriers. Our mission is to provide free hosting services to gamers and communities, allowing them to create and enjoy game servers without worrying about costs."
          />

          <Accordion
            title="Is the hosting really free?"
            details="Yes, our hosting services are completely free forever. There are no hidden fees or charges. We believe in providing reliable hosting without any cost to our users."
          />

          <Accordion
            title="How do I change my egg/package?"
            details="Just create a ticket in our support system and we will change it for you free of charge."
          />

          <Accordion
            title="How can I get better specs for my server?"
            details="Better specifications are reserved for Ko-fi supporters. Consider supporting us on Ko-fi to get access to higher performance options. ( This is optional and not required to use our free hosting services )"
          />

          <Accordion
            title="Is there a limit to how many servers I can create?"
            details="Yes, to ensure fair usage and resource availability for all users, there is a limit of 2 free servers per account."
          />

          <Accordion
            title="What if I need help or support?"
            details="We offer support through our ticketing system. If you encounter any issues or have questions, feel free to reach out and our team will assist you."
          />

          <Accordion
            title="What does supporting on Ko-fi provide?"
            details="Supporting us on Ko-fi helps us maintain and improve our hosting services. As a token of appreciation, Ko-fi supporters gain access to enhanced server specifications, early acess to new nodes, and priority support."
          />
        </div>
      </section>
    </FancyDiv>

    <FancyDiv isAnimated={true} theme="default_big" margin_bottom="50">
      <section id="features" class="relative animate">
        <p
          class="text-xl md:text-2xl lg:text-3xl font-bold uppercase text-black dark:text-white animate"
        >
          Changelog
        </p>

        <p class="font-bold text-sm mb-2 animate">What's new?</p>

        <div>
          <ul class="space-y-4">
            {
              posts.map((post) => (
                <li>
                  <BlogSummary entry={post} />
                </li>
              ))
            }
          </ul>
        </div>
      </section>
    </FancyDiv>
  </div>
</PageLayout>

<script>
  // Tip progress bar
  async function fetchTipData() {
    try {
      const response = await fetch("https://api.nikostuff.com/v2/hosting/kofi"); // Returns {"total":41.95}
      if (!response.ok) {
        throw new Error("Network response was not ok");
      }
      const data = await response.json();
      return { current_amount: data.total, goal_amount: 60 };
    } catch (error) {
      console.error("Error fetching tip data:", error);
      return null;
    }
  }

  let lastTipAmount: number = 0;

  async function updateTipProgress() {
    const tipData = await fetchTipData();
    if (tipData) {
      const { current_amount, goal_amount } = tipData;
      const progressBar = document.getElementById("tip_progress_bar");
      const progressPercent = Math.min(
        (current_amount / goal_amount) * 100,
        100
      );
      if (!progressBar) return;
      const end = Math.floor(current_amount);

      // If amount didn't change, do nothing
      if (lastTipAmount === end) return;

      progressBar.style.width = `${progressPercent}%`;

      const tipValueElement = document.getElementById("tip_value");
      if (tipValueElement) {
        const duration = 500;
        const start = lastTipAmount !== null ? lastTipAmount : 0;
        // If no change (caught above) or end equals start, just set and return
        if (end === start) {
          tipValueElement.textContent = `${end}$`;
          lastTipAmount = end;
          return;
        }

        const delta = end - start;
        const steps = Math.abs(delta);
        const stepTime = Math.max(1, Math.floor(duration / steps));
        let current = start;

        const timer = setInterval(() => {
          current += delta > 0 ? 1 : -1;
          tipValueElement.textContent = `${current}$`;
          if ((delta > 0 && current >= end) || (delta < 0 && current <= end)) {
            clearInterval(timer);
            tipValueElement.textContent = `${end}$`;
            lastTipAmount = end;
          }
        }, stepTime);
      } else {
        lastTipAmount = end;
      }
    }
  }

  // Initial update
  updateTipProgress();

  // Update every 5 seconds
  setInterval(updateTipProgress, 5000);
</script>
